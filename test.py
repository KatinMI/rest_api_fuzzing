import binascii
import os

# Гекс-данные сообщений (в порядке из ответа)
hex_msgs = [
    "123401000001000000000000076578616d706c6503636f6d0000010001",
    "123485800001000100000000076578616d706c6503636f6d0000010001c00c00010001000000ff00045db8d822",
    "5678010000010000000000000469707636076578616d706c6503636f6d00001c0001",
    "5678858000010001000000000469707636076578616d706c6503636f6d00001c0001c00c001c0001000000ff001026062800022000010248189325c81946",
    "abcd01000001000000000000076578616d706c6503636f6d00000f0001",
    "abcd85800001000200000000076578616d706c6503636f6d00000f0001c00c000f0001000000ff0008000a036e7331c00cc00c000f0001000000ff00080014036e7332c00c",
    "111101000001000000000000076578616d706c6503636f6d0000100001",
    "111185800001000100000000076578616d706c6503636f6d0000100001c00c00100001000000ff000e0d48656c6c6f2c20776f726c6421",
    "222201000001000000000000076578616d706c6503636f6d0000020001",
    "222285800001000200000000076578616d706c6503636f6d0000020001c00c00020001000000ff0006036e7331c00cc00c00020001000000ff0006036e7332c00c",
    "33330100000100000000000003737562076578616d706c6503636f6d0000050001",
    "33338580000100010000000003737562076578616d706c6503636f6d0000050001c00c00050001000000ff000806746172676574c010",
    "444401000001000000000000076578616d706c6503636f6d0000060001",
    "444485800001000100000000076578616d706c6503636f6d0000060001c00c00060001000000ff0022036e7331c00c0561646d696ec00c0000000100000002000000030000000400000005",
    "5555010000010000000000000131013001300331323707696e2d61646472046172706100000c0001",
    "5555858000010001000000000131013001300331323707696e2d61646472046172706100000c0001c00c000c0001000000ff000b096c6f63616c686f737400",
    "666601000001000000000100076578616d706c6503636f6d00000100010000291000000080000000",
    "666685800001000100000001076578616d706c6503636f6d0000010001c00c00010001000000ff00045db8d8220000291000000080000000",
    "7777818300010000000000000c6e6f6e2d6578697374696e67076578616d706c6503636f6d0000010001",
    "888883800001000100000000076578616d706c6503636f6d0000010001c00c00010001000000ff00045db8"
]

# Создаем директорию для файлов
os.makedirs("dns_corpus", exist_ok=True)

# Конвертируем и сохраняем
for i, hex_str in enumerate(hex_msgs, 1):
    # Удаляем возможные пробелы и комментарии
    clean_hex = ''.join(hex_str.split()).split('//')[0]
    if not clean_hex:
        continue
        
    # Конвертация в бинарный формат
    try:
        bin_data = binascii.unhexlify(clean_hex)
        with open(f"dns_corpus/msg_{i}.dns", "wb") as f:
            f.write(bin_data)
        print(f"Создан файл dns_corpus/msg_{i}.dns ({len(bin_data)} байт)")
    except binascii.Error:
        print(f"Ошибка в сообщении {i}: {clean_hex}")

print("\nКорпус успешно создан в директории dns_corpus/")
